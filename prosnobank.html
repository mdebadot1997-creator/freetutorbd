<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>প্রশ্নব্যাংক - FreeTutorBD</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Hind+Siliguri:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        *{margin:0;padding:0;box-sizing:border-box;font-family:'Hind Siliguri',sans-serif;}
        body{background:#f5f7fa;color:#333;padding-top:80px;}
        
        /* Header */
        .main-header{
            background:linear-gradient(135deg,#2c3e50,#34495e);
            color:white;padding:15px 0;box-shadow:0 2px 10px rgba(0,0,0,0.1);
            position:fixed;top:0;left:0;right:0;z-index:1000;
        }
        .header-container{
            max-width:1400px;margin:0 auto;padding:0 20px;
            display:flex;justify-content:space-between;align-items:center;
        }
        .logo{display:flex;align-items:center;gap:15px;}
        .logo-icon{
            width:50px;height:50px;background:white;border-radius:10px;
            display:flex;align-items:center;justify-content:center;
            border:2px solid #3498db;
        }
        .logo-text h1{color:#3498db;font-size:24px;margin-bottom:5px;}
        .logo-text p{color:#bdc3c7;font-size:12px;}
        .main-nav{display:flex;gap:25px;}
        .nav-link{
            color:#ecf0f1;text-decoration:none;font-weight:500;padding:8px 15px;
            border-radius:5px;transition:all 0.3s;display:flex;align-items:center;gap:8px;
        }
        .nav-link:hover{background:rgba(255,255,255,0.1);color:#3498db;}
        .nav-link.active{background:#3498db;color:white;}
        .mobile-menu-btn{display:none;background:none;border:none;color:white;font-size:24px;cursor:pointer;}
        
        /* Category Filter */
        .category-filter-box{
            max-width:1400px;margin:20px auto 10px;padding:0 20px;
        }
        .filter-container{
            background:white;padding:10px 15px;border-radius:8px;
            box-shadow:0 2px 5px rgba(0,0,0,0.05);
        }
        .filter-select{
            width:100%;padding:10px 15px;border:1px solid #ddd;
            border-radius:5px;font-size:14px;background:white;
        }
        
        /* Main Container */
        .main-container{
            max-width:1400px;margin:20px auto;padding:0 20px;
            display:grid;grid-template-columns:250px 1fr 300px;gap:20px;
        }
        
        /* Left Sidebar */
        .sidebar-left{
            background:white;border-radius:10px;box-shadow:0 3px 10px rgba(0,0,0,0.05);
            padding:15px;position:sticky;top:100px;
        }
        .sidebar-title{
            color:#2c3e50;margin-bottom:15px;font-size:16px;
            display:flex;align-items:center;gap:10px;
        }
        .category-list{list-style:none;}
        .category-item{
            padding:10px;margin-bottom:5px;cursor:pointer;border-radius:5px;
            transition:all 0.3s;display:flex;justify-content:space-between;
        }
        .category-item:hover{background:#e3f2fd;}
        .category-item.active{background:#3498db;color:white;}
        .category-count{
            background:#ecf0f1;padding:2px 6px;border-radius:10px;font-size:11px;
        }
        .category-item.active .category-count{background:rgba(255,255,255,0.3);}
        
        /* Right Sidebar */
        .sidebar-right{
            background:white;border-radius:10px;box-shadow:0 3px 10px rgba(0,0,0,0.05);
            padding:15px;position:sticky;top:100px;
        }
        .test-maker{
            background:linear-gradient(135deg,#27ae60,#219653);color:white;
            padding:20px;text-align:center;border-radius:10px;margin-bottom:15px;
        }
        .test-btn{
            background:white;color:#27ae60;border:none;padding:10px 20px;
            border-radius:50px;font-weight:600;cursor:pointer;margin-top:10px;
            display:inline-flex;align-items:center;gap:10px;
        }
        .ad-box{
            background:#f8f9fa;border:1px dashed #ddd;border-radius:8px;
            padding:20px;text-align:center;color:#666;margin-bottom:10px;
        }
        
        /* Main Content */
        .main-content{
            background:white;border-radius:10px;box-shadow:0 3px 10px rgba(0,0,0,0.05);
            padding:20px;min-height:500px;
        }
        .page-title{
            color:#2c3e50;margin-bottom:20px;padding-bottom:10px;
            border-bottom:1px solid #eee;font-size:20px;
        }
        
        /* Questions */
        .question-item{
            margin-bottom:25px;padding-bottom:20px;border-bottom:1px solid #eee;
        }
        .question-number{
            display:inline-block;background:#3498db;color:white;
            width:25px;height:25px;border-radius:50%;text-align:center;
            line-height:25px;margin-right:8px;font-size:12px;font-weight:bold;
        }
        .question-text{
            font-size:16px;color:#2c3e50;line-height:1.6;
            display:inline;margin-bottom:10px;
        }
        .answer-text{
            color:#27ae60;font-size:15px;margin-top:10px;margin-left:35px;
        }
        
        /* Pagination */
        .pagination{
            display:flex;justify-content:center;align-items:center;
            gap:5px;margin-top:30px;padding-top:20px;border-top:1px solid #eee;
        }
        .page-btn{
            background:white;border:1px solid #ddd;color:#555;
            width:35px;height:35px;border-radius:5px;cursor:pointer;
        }
        .page-btn.active{background:#3498db;border-color:#3498db;color:white;}
        
        /* Footer */
        .main-footer{
            background:#2c3e50;color:white;padding:20px 0;margin-top:40px;
            text-align:center;font-size:14px;
        }
        
        /* Mobile */
        @media (max-width:768px){
            body{padding-top:70px;}
            .main-nav{display:none;}
            .mobile-menu-btn{display:block;}
            .main-container{grid-template-columns:1fr;}
            .sidebar-left,.sidebar-right{display:none;}
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="main-header">
        <div class="header-container">
            <div class="logo">
                <div class="logo-icon">
                    <i class="fas fa-chalkboard-teacher" style="font-size:24px;color:#3498db;"></i>
                </div>
                <div class="logo-text">
                    <h1>FreeTutorBD</h1>
                    <p>প্রশ্নব্যাংক</p>
                </div>
            </div>
            <nav class="main-nav">
                <a href="index.html" class="nav-link"><i class="fas fa-home"></i> হোম</a>
                <a href="questions.html" class="nav-link active"><i class="fas fa-question-circle"></i> প্রশ্নব্যাংক</a>
                <a href="quiz.html" class="nav-link"><i class="fas fa-puzzle-piece"></i> কুইজ</a>
                <a href="exams.html" class="nav-link"><i class="fas fa-file-alt"></i> মডেল টেস্ট</a>
                <a href="jobs.html" class="nav-link"><i class="fas fa-briefcase"></i> চাকরি</a>
            </nav>
            <button class="mobile-menu-btn" id="mobileMenuBtn"><i class="fas fa-bars"></i></button>
        </div>
    </header>

    <!-- Category Filter -->
    <div class="category-filter-box">
        <div class="filter-container">
            <select class="filter-select" id="categoryFilter">
                <option value="all">সকল প্রশ্ন</option>
            </select>
        </div>
    </div>

    <!-- Main Container -->
    <div class="main-container">
        <!-- Left Sidebar -->
        <aside class="sidebar-left">
            <h3 class="sidebar-title"><i class="fas fa-folder"></i> প্রশ্ন ক্যাটাগরি</h3>
            <ul class="category-list" id="questionCategories">
                <li class="category-item active" data-category="all">
                    <span>সকল প্রশ্ন</span>
                    <span class="category-count" id="all-count">0</span>
                </li>
            </ul>
            
            <h3 class="sidebar-title" style="margin-top:20px;"><i class="fas fa-briefcase"></i> চাকরি ক্যাটাগরি</h3>
            <ul class="category-list" id="jobCategories"></ul>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <h2 class="page-title"><i class="fas fa-question-circle"></i> <span id="pageTitle">সকল প্রশ্ন</span></h2>
            <div id="questionsContainer">প্রশ্ন লোড হচ্ছে...</div>
            <div class="pagination" id="pagination"></div>
        </main>

        <!-- Right Sidebar -->
        <aside class="sidebar-right">
            <div class="test-maker">
                <h3>নিজের টেস্ট তৈরি করুন</h3>
                <button class="test-btn" onclick="window.location.href='mcqtest.html'">
                    <i class="fas fa-plus-circle"></i> টেস্ট তৈরি
                </button>
            </div>
            
            <div class="ad-box">
                <i class="fas fa-ad fa-2x" style="margin-bottom:10px;"></i>
                <p>AdSense বিজ্ঞাপন</p>
            </div>
            <div class="ad-box">
                <i class="fas fa-ad fa-2x" style="margin-bottom:10px;"></i>
                <p>Adstra বিজ্ঞাপন</p>
            </div>
        </aside>
    </div>

    <!-- Footer -->
    <footer class="main-footer">
        <div class="footer-container">
            <p>© 2024 FreeTutorBD. সকল অধিকার সংরক্ষিত।</p>
        </div>
    </footer>

    <!-- Firebase -->
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
    
    <script>
        // Firebase Config
        const firebaseConfig = {
            apiKey: "AIzaSyCbfCCosPtMmkxbjp0yjBmJKo_vzzUYEiQ",
            authDomain: "freetutorbd-19380.firebaseapp.com",
            projectId: "freetutorbd-19380",
            storageBucket: "freetutorbd-19380.firebasestorage.app",
            messagingSenderId: "741837856466",
            appId: "1:741837856466:web:8b5a3b34183991e2f9570b"
        };
        
        // Initialize
        if (!firebase.apps.length) {
            firebase.initializeApp(firebaseConfig);
        }
        const db = firebase.firestore();
        
        // Variables
        let currentCategory = 'all';
        let currentPage = 1;
        const perPage = 20;
        
        // Load on start
        document.addEventListener('DOMContentLoaded', function() {
            loadCategories();
            loadQuestions();
            
            // Filter change
            document.getElementById('categoryFilter').addEventListener('change', function(e) {
                currentCategory = e.target.value;
                currentPage = 1;
                updateUI();
                loadQuestions();
            });
        });
        
        // Load Categories
        async function loadCategories() {
            try {
                const snapshot = await db.collection('questions').get();
                const categories = {};
                
                snapshot.forEach(doc => {
                    const q = doc.data();
                    const cat = q.category || 'অন্যান্য';
                    categories[cat] = (categories[cat] || 0) + 1;
                });
                
                // Update counts
                document.getElementById('all-count').textContent = snapshot.size;
                
                // Add to left sidebar
                const sidebar = document.getElementById('questionCategories');
                const filter = document.getElementById('categoryFilter');
                
                Object.keys(categories).forEach(cat => {
                    if (categories[cat] > 0) {
                        // Sidebar item
                        const li = document.createElement('li');
                        li.className = 'category-item';
                        li.setAttribute('data-category', cat);
                        li.innerHTML = `<span>${cat}</span><span class="category-count">${categories[cat]}</span>`;
                        li.addEventListener('click', () => {
                            selectCategory(cat);
                        });
                        sidebar.appendChild(li);
                        
                        // Filter option
                        const option = document.createElement('option');
                        option.value = cat;
                        option.textContent = `${cat} (${categories[cat]})`;
                        filter.appendChild(option);
                    }
                });
                
            } catch (error) {
                console.error("Category load error:", error);
            }
        }
        
        // Select Category
        function selectCategory(cat) {
            currentCategory = cat;
            currentPage = 1;
            updateUI();
            loadQuestions();
            document.getElementById('categoryFilter').value = cat;
        }
        
        // Update UI
        function updateUI() {
            // Update title
            const title = document.getElementById('pageTitle');
            title.textContent = currentCategory === 'all' ? 'সকল প্রশ্ন' : currentCategory;
            
            // Update active category
            document.querySelectorAll('.category-item').forEach(item => {
                item.classList.remove('active');
                if (item.getAttribute('data-category') === currentCategory) {
                    item.classList.add('active');
                }
            });
        }
        
        // Load Questions
        async function loadQuestions() {
            const container = document.getElementById('questionsContainer');
            container.innerHTML = 'প্রশ্ন লোড হচ্ছে...';
            
            try {
                let query = db.collection('questions');
                if (currentCategory !== 'all') {
                    query = query.where('category', '==', currentCategory);
                }
                
                const totalSnapshot = await query.get();
                const total = totalSnapshot.size;
                
                const snapshot = await query
                    .orderBy('createdAt', 'desc')
                    .limit(perPage)
                    .offset((currentPage - 1) * perPage)
                    .get();
                
                if (snapshot.empty) {
                    container.innerHTML = '<div style="text-align:center;padding:40px;color:#666;">কোন প্রশ্ন নেই</div>';
                    document.getElementById('pagination').innerHTML = '';
                    return;
                }
                
                let html = '';
                let index = (currentPage - 1) * perPage + 1;
                
                snapshot.forEach(doc => {
                    const q = doc.data();
                    const correctIndex = q.correctAnswer || 1;
                    const answerText = q['option' + correctIndex] || 'উত্তর নেই';
                    const answerLetter = ['ক', 'খ', 'গ', 'ঘ'][correctIndex - 1] || 'ক';
                    
                    html += `
                        <div class="question-item">
                            <div>
                                <span class="question-number">${index}</span>
                                <span class="question-text">${q.question || ''}</span>
                            </div>
                            <div class="answer-text">উত্তর: ${answerLetter}. ${answerText}</div>
                        </div>
                    `;
                    index++;
                });
                
                container.innerHTML = html;
                generatePagination(total);
                
            } catch (error) {
                console.error("Question load error:", error);
                container.innerHTML = `<div style="color:red;text-align:center;padding:40px;">
                    Error: ${error.message}<br>
                    <button onclick="location.reload()" style="margin-top:10px;padding:8px 16px;background:#3498db;color:white;border:none;border-radius:5px;">
                        আবার চেষ্টা করুন
                    </button>
                </div>`;
            }
        }
        
        // Pagination
        function generatePagination(total) {
            const totalPages = Math.ceil(total / perPage);
            const pagination = document.getElementById('pagination');
            
            if (totalPages <= 1) {
                pagination.innerHTML = '';
                return;
            }
            
            let html = '';
            for (let i = 1; i <= totalPages; i++) {
                html += `<button class="page-btn ${i === currentPage ? 'active' : ''}" onclick="goToPage(${i})">${i}</button>`;
            }
            pagination.innerHTML = html;
        }
        
        function goToPage(page) {
            currentPage = page;
            loadQuestions();
            window.scrollTo({top: 0, behavior: 'smooth'});
        }
        
        // Load Job Categories
        async function loadJobCategories() {
            try {
                const snapshot = await db.collection('jobs').get();
                const categories = {};
                
                snapshot.forEach(doc => {
                    const job = doc.data();
                    const cat = job.category || 'অন্যান্য';
                    categories[cat] = (categories[cat] || 0) + 1;
                });
                
                const container = document.getElementById('jobCategories');
                Object.keys(categories).forEach(cat => {
                    if (categories[cat] > 0) {
                        const li = document.createElement('li');
                        li.className = 'category-item';
                        li.innerHTML = `<span>${cat}</span><span class="category-count">${categories[cat]}</span>`;
                        li.addEventListener('click', () => {
                            window.location.href = 'jobs.html';
                        });
                        container.appendChild(li);
                    }
                });
            } catch (error) {
                console.error("Job category error:", error);
            }
        }
        
        // Load job categories
        loadJobCategories();
        
    </script>
</body>
</html>
